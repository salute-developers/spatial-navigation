<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="application-name" content="API :spatNavSearch()">
    <meta name="author" content="jeonghee Ahn">
    <meta name="description" content="element.spatNavSearch(SpatNavSearchOptions) return next best target. You can check the result of element.spatNavSearch() as border-color.">
    <link rel="stylesheet" href="spatnav-style.css">
    <script src="spatnav-utils.js"></script>
    <script src="../../polyfill/spatnav-heuristic.js"></script>
    <script src="../../polyfill/spatnav-api.js"></script>
    <script type="text/javascript">
      let previousTarget;

      const init = function(e) {
        console.log('========init=======');
        onChangeSelect();
      };

      function callSpatNavSearch(selectValue) {
        if(previousTarget) {
          previousTarget.style.border = '';
        }

        const currentElement = document.getElementById('current');
        let SpatNavSearchOptions;

        if (selectValue === 'dir') {
          SpatNavSearchOptions = {dir: 'right', candidates: currentElement.getSpatnavContainer().focusableAreas({'mode': 'all'})};
        } else if (selectValue === 'candidates') {
          SpatNavSearchOptions = {dir: 'right', candidates: [...document.getElementsByClassName('b2')]};
        } else if (selectValue === 'container') {
          SpatNavSearchOptions = {dir: 'right', candidates: [...document.getElementsByClassName('b2')], container: document.getElementsByClassName('container c1')[0]};
        }

        const nextTarget = currentElement.spatNavSearch(SpatNavSearchOptions.dir, SpatNavSearchOptions.candidates,  SpatNavSearchOptions.container);
        if(nextTarget) {
          nextTarget.style.border = '2px solid red';
        }
        previousTarget = nextTarget;
        console.log(nextTarget);
      }

      function onChangeSelect() {
          const selectValue = document.getElementById('option').value;
          callSpatNavSearch(selectValue);

          let selectedOptionString;
          if (selectValue === 'dir') {
            selectedOptionString = `{dir:'right'}`;
          } else if (selectValue === 'candidates') {
            selectedOptionString = `{dir:'right', candidates:[redBoxs]}`;
          } else if (selectValue === 'container') {
            selectedOptionString = `{dir:'right', candidates:[redBoxs], container:redContainer}`;
          }

          document.getElementById('code').innerHTML = `// Node spatNavSearch(SpatNavSearchOptions arg);
          nextTarget = currentElement.spatNavSearch(${selectedOptionString});
          if (nextTarget)
            nextTarget.style.border = '2px solid red';
          console.log(nextTarget);`
      }

    </script>
  </head>
  <body onload="init()">
    <div style="width:600px; height:300px; padding:20px;">
      <h4>
        <span>spatnav container 1(Document)</span> >
        <span class="c1">spatnav container 2</span> >
        <span class="c2">spatnav container 3</span>
      </h4>
      <div class="container c1" style="position:relative; width:500px; height:200px; --spatial-navigation-contain:contain;">
          <div class="container c2" style="position:relative; width:250px; height:160px; --spatial-navigation-contain:contain;">
            <button class="box b3" id="current" style="top:20px; width:fit-content;">current</button>
            <button class="box b3" style="left:150px;"></button>
          </div>
        <button class="box b2" style="top:-80px; left:100px;"></button>
        <button class="box b2" style="top:-80px; left:320px;"></button>
      </div>
      <button class="box" style="top:-120px; left:400px; background:lightgray;"></button>
      <button class="box" style="top:-120px; left:650px; background:lightgray;"></button>
    </div>

    <select id="option" onchange="onChangeSelect()" style="margin:0 20px">
      <option value="dir" selected>{dir}</option>
      <option value="candidates">{dir, candidates}</option>
      <option value="container">{dir, candidates, container}</option>
    </select>
    <pre class="code-area">
      <code id="code"></code>
    </pre>
  </body>
</html>
